package group.skids.requiem.module.impl.exploits;

import group.skids.requiem.events.UpdateEvent;
import group.skids.requiem.mixin.accessors.IPlayerControllerMP;
import group.skids.requiem.module.Module;
import net.b0at.api.event.Subscribe;
import net.b0at.api.event.types.EventType;
import net.minecraft.init.MobEffects;
import net.minecraft.item.ItemStack;
import net.minecraft.potion.PotionEffect;
import net.minecraft.util.EnumHand;

import java.awt.*;

public class SpeedMine extends Module {

    public SpeedMine() {
        super("SpeedMine", Category.EXPLOITS, new Color(0x4DAE99).getRGB());
        setDescription("Mine Faster.");
    }

    @Override
    public void onDisable() {
        getMc().player.removePotionEffect(MobEffects.HASTE);
    }

    @Override
    public void onEnable() {
    }

    @Subscribe
    public void onUpdate(UpdateEvent event) {
        if (getMc().world == null || getMc().player == null) return;
        if (event.getEventType() == EventType.PRE) {
            ((IPlayerControllerMP)getMc().playerController).setBlockHitDelay(0);
            boolean item = getMc().player.getHeldItem(EnumHand.MAIN_HAND) == ItemStack.EMPTY;
            getMc().player.addPotionEffect(new PotionEffect(MobEffects.HASTE, 100, item ? 1 : 0));
        }
    }
}
